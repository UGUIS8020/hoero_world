{% extends "common/base.html" %}

{# SEOæœ€é©åŒ– #}
{% block title %}è‡ªå®¶æ­¯ç‰™ç§»æ¤ãƒ‹ãƒ¥ãƒ¼ã‚¹ï¼ˆæœ€æ–°ç ”ç©¶ãƒ»ç—‡ä¾‹ãƒ»ãƒ‡ã‚¸ã‚¿ãƒ«æŠ€è¡“ï¼‰| SHIBUYA Dental Laboratory{% endblock %}
{% block description %}
è‡ªå®¶æ­¯ç‰™ç§»æ¤ï¼ˆtooth autotransplantationï¼æ­¯ç‰™ç§»æ¤ï¼‰ã«é–¢ã™ã‚‹æœ€æ–°ç ”ç©¶ãƒ»ç—‡ä¾‹å ±å‘Šãƒ»ãƒ‡ã‚¸ã‚¿ãƒ«ã‚¬ã‚¤ãƒ‰ã‚„3Dãƒ¬ãƒ—ãƒªã‚«ãªã©ã®æŠ€è¡“æƒ…å ±ã‚’è‡ªå‹•åé›†ã—ã¦æ²è¼‰ã™ã‚‹æ­¯ç§‘å°‚é–€ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒšãƒ¼ã‚¸ã§ã™ã€‚
{% endblock %}
{% block keywords %}
è‡ªå®¶æ­¯ç‰™ç§»æ¤,æ­¯ç‰™ç§»æ¤,ã‚ªãƒ¼ãƒˆãƒˆãƒ©ãƒ³ã‚¹ãƒ—ãƒ©ãƒ³ãƒˆ,è‡ªå®¶æ­¯ç‰™ç§»æ¤ ãƒ¬ãƒ—ãƒªã‚«,ãƒ‡ã‚¸ã‚¿ãƒ«ãƒ‰ãƒŠãƒ¼ãƒ¬ãƒ—ãƒªã‚«,3Dãƒ—ãƒªãƒ³ãƒˆ ã‚¬ã‚¤ãƒ‰ã‚µãƒ¼ã‚¸ã‚§ãƒªãƒ¼,ç§»æ¤çª©å½¢æˆ,æ­¯æ ¹è†œæ¸©å­˜,tooth autotransplantation,autogenous tooth transplantation,dental autotransplantation
{% endblock %}

{% block extra_meta %}
  {# æ­£è¦URLï¼ˆcanonicalï¼‰ #}
  <link rel="canonical" href="https://shibuya8020.com/dental_news">

  {# æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³å‘ã‘ã®ãƒ¡ã‚¿ã‚¿ã‚° #}
  <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large">
  <meta name="googlebot" content="index, follow">
  <meta name="author" content="SHIBUYA Dental Laboratory">

  {# Open Graphï¼ˆFacebookç­‰ã®SNSç”¨ï¼‰ #}
  <meta property="og:type" content="website">
  <meta property="og:title" content="è‡ªå®¶æ­¯ç‰™ç§»æ¤ãƒ‹ãƒ¥ãƒ¼ã‚¹ - æœ€æ–°ç ”ç©¶ã¨æŠ€è¡“æƒ…å ±">
  <meta property="og:description" content="è‡ªå®¶æ­¯ç‰™ç§»æ¤ã®æœ€æ–°ç ”ç©¶ã€ç—‡ä¾‹å ±å‘Šã€3Dãƒ¬ãƒ—ãƒªã‚«ã‚„ãƒ‡ã‚¸ã‚¿ãƒ«ã‚¬ã‚¤ãƒ‰ãªã©ã®æŠ€è¡“æƒ…å ±ã‚’è‡ªå‹•åé›†ã—ã¦é…ä¿¡ã€‚æ­¯ç§‘åŒ»å¸«ãƒ»æŠ€å·¥å£«å‘ã‘ã®å°‚é–€ãƒ‹ãƒ¥ãƒ¼ã‚¹ã§ã™ã€‚">
  <meta property="og:url" content="https://shibuya8020.com/dental_news">
  <meta property="og:image" content="https://shibuya8020.com/static/images/dental_news_og.jpg">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="è‡ªå®¶æ­¯ç‰™ç§»æ¤ã¨ãƒ‡ã‚¸ã‚¿ãƒ«ãƒ¬ãƒ—ãƒªã‚«æŠ€è¡“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ç”»åƒ">
  <meta property="og:locale" content="ja_JP">
  <meta property="og:site_name" content="SHIBUYA Dental Laboratory">
  {# è‹±èªãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚‚æ‰±ã†ã®ã§ã€å°†æ¥çš„ã«è‹±èªç‰ˆãƒšãƒ¼ã‚¸ã‚’ä½œã‚‹ãªã‚‰ alternate ã‚’è¿½åŠ ã—ã¦ã‚‚ã‚ˆã„ #}
  {# <meta property="og:locale:alternate" content="en_US"> #}

  {# Twitter Card #}
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="è‡ªå®¶æ­¯ç‰™ç§»æ¤ãƒ‹ãƒ¥ãƒ¼ã‚¹ - æœ€æ–°ç ”ç©¶ã¨æŠ€è¡“æƒ…å ±">
  <meta name="twitter:description" content="è‡ªå®¶æ­¯ç‰™ç§»æ¤ã®æœ€æ–°ç ”ç©¶ãƒ»ç—‡ä¾‹ãƒ»ãƒ‡ã‚¸ã‚¿ãƒ«ãƒ¬ãƒ—ãƒªã‚«æŠ€è¡“ã‚’AIãŒè‡ªå‹•åé›†ã€‚æ­¯ç§‘è‡¨åºŠã¨æŠ€å·¥ã®ä¸¡é¢ã‹ã‚‰æƒ…å ±ã‚’æ•´ç†ã—ã¦é…ä¿¡ã€‚">
  <meta name="twitter:image" content="https://shibuya8020.com/static/images/dental_news_og.jpg">
  <meta name="twitter:image:alt" content="è‡ªå®¶æ­¯ç‰™ç§»æ¤æŠ€è¡“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ç”»åƒ">

  {# ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆç”¨æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ #}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "ãƒ›ãƒ¼ãƒ ",
        "item": "https://shibuya8020.com/"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "è‡ªå®¶æ­¯ç‰™ç§»æ¤ãƒ‹ãƒ¥ãƒ¼ã‚¹",
        "item": "https://shibuya8020.com/dental_news"
      }
    ]
  }
  </script>

  {# ãã®ä»–ã®SEOå‘ä¸Šã‚¿ã‚° #}
  <meta name="revisit-after" content="1 days">
{% endblock %}

{% block jsonld %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "NewsMediaOrganization",
      "name": "SHIBUYA Dental News",
      "url": "https://shibuya8020.com/dental_news",
      "logo": {
        "@type": "ImageObject",
        "url": "https://shibuya8020.com/static/images/logo.png"
      },
      "sameAs": [
        "https://shibuya8020.com/"
      ],
      "description": "è‡ªå®¶æ­¯ç‰™ç§»æ¤ã®æœ€æ–°ç ”ç©¶ã¨æŠ€è¡“æƒ…å ±ã‚’é…ä¿¡ã™ã‚‹æ­¯ç§‘å°‚é–€ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚µã‚¤ãƒˆ"
    },
    {
      "@type": "CollectionPage",
      "name": "è‡ªå®¶æ­¯ç‰™ç§»æ¤ãƒ‹ãƒ¥ãƒ¼ã‚¹",
      "url": "https://shibuya8020.com/dental_news",
      "inLanguage": "ja",
      "isPartOf": {
        "@type": "WebSite",
        "name": "SHIBUYA Dental Laboratory",
        "url": "https://shibuya8020.com/"
      },
      "description": "è‡ªå®¶æ­¯ç‰™ç§»æ¤ã®ç ”ç©¶è«–æ–‡ãƒ»ç—‡ä¾‹å ±å‘Šãƒ»ãƒ‡ã‚¸ã‚¿ãƒ«ãƒ¬ãƒ—ãƒªã‚«æŠ€è¡“ãªã©ã‚’é›†ç´„ã—ãŸãƒ‹ãƒ¥ãƒ¼ã‚¹ä¸€è¦§ãƒšãƒ¼ã‚¸ã€‚",
      "about": [
        {
          "@type": "MedicalProcedure",
          "name": "Tooth autotransplantation"
        },
        {
          "@type": "MedicalTherapy",
          "name": "Autogenous tooth transplantation"
        }
      ]
    }
  ]
}
</script>
{% endblock %}

{% block content %}
    
<section id="dental-news-section" style="max-width: 1200px; margin: 60px auto; padding: 20px;">
    <style>
        .dental-news-header {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .news-filters {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 8px 16px;
            background: #e0e0e0;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .filter-btn.active {
            background: #2c5282;
            color: white;
        }
        
        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }
        
        .news-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .news-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        
        .news-card-content {
            padding: 20px;
        }
        
        .news-card-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .news-card-title a {
            text-decoration: none;
            color: #333;
        }
        
        .news-card-title a:hover {
            color: #2c5282;
        }
        
        .news-meta {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }
        
        .news-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            color: white;
        }
        
        .badge-research { background: #38a169; }
        .badge-case { background: #d69e2e; }
        .badge-video { background: #e53e3e; }
        .badge-product { background: #805ad5; }
        .badge-market { background: #3182ce; }
        
        .lang-flag {
            font-size: 16px;
        }
        
        .news-date {
            color: #666;
            font-size: 12px;
        }
        
        .news-summary {
            color: #666;
            font-size: 13px;
            line-height: 1.5;
            margin: 10px 0;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .news-author {
            color: #999;
            font-size: 12px;
            margin-top: 10px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        @media (max-width: 768px) {
            .news-grid {
                grid-template-columns: 1fr;
            }
            
            .news-filters {
                flex-direction: column;
            }
        }
    </style>
    
    <div class="dental-news-header">
        <h2>è‡ªå®¶æ­¯ç‰™ç§»æ¤ æœ€æ–°æƒ…å ±</h2>
        <p style="color: #666; margin: 10px 0;">
            AIãŒè‡ªå‹•åé›†ã—ãŸè‡ªå®¶æ­¯ç‰™ç§»æ¤ã«é–¢ã™ã‚‹æœ€æ–°ã®ç ”ç©¶è«–æ–‡ã€ç—‡ä¾‹å ±å‘Šã€æŠ€è¡“æƒ…å ±
            ï¼ˆå…¨ <span id="total-count">-</span> ä»¶ï¼‰
        </p>

        {# â–¼ ç®¡ç†äººå°‚ç”¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« â–¼ #}
        {% if current_user.is_authenticated and current_user.administrator %}
        <div>
            <a href="/news/admin/clear_all_dental_news">å…¨ã‚¯ãƒªã‚¢</a>
            ï½œ
            <a href="/news/admin/run_autotransplant_news">ãƒ‹ãƒ¥ãƒ¼ã‚¹å†å–å¾—</a>
        </div>
        {% endif %}      

       
        
        <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
        <div class="news-filters">
            <button class="filter-btn active" data-filter="all" onclick="filterNews('all', this)">
                å…¨ã¦
            </button>
            <button class="filter-btn" data-filter="research" onclick="filterNews('research', this)">
                ğŸ“„ ç ”ç©¶è«–æ–‡
            </button>
            <button class="filter-btn" data-filter="case" onclick="filterNews('case', this)">
                ğŸ“‹ ç—‡ä¾‹å ±å‘Š
            </button>
            <button class="filter-btn" data-filter="product" onclick="filterNews('product', this)">
                ğŸ­ è£½å“æƒ…å ±
            </button>
            <button class="filter-btn" data-filter="video" onclick="filterNews('video', this)">
                ğŸ¥ å‹•ç”»
            </button>
            <button class="filter-btn" data-filter="ja" onclick="filterNews('ja', this)">
                ğŸ‡¯ğŸ‡µ æ—¥æœ¬èªã®ã¿
            </button>
            <button class="filter-btn" data-filter="en" onclick="filterNews('en', this)">
                ğŸ‡¬ğŸ‡§ English only
            </button>
        </div>
    </div>
    
    <div id="news-container" class="news-grid">
        <div class="loading">è¨˜äº‹ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
    </div>
    
    <div style="text-align: center; margin-top: 30px;">
        <a href="/news/autotransplant_news?kind=research&lang=ja" 
           style="display: inline-block; padding: 12px 24px; background: #2c5282; color: white; text-decoration: none; border-radius: 6px;">
            ã™ã¹ã¦ã®è¨˜äº‹ã‚’è¦‹ã‚‹ â†’
        </a>
    </div>
</section>

<script>
let allDentalNews = [];
let currentFilter = 'all';

// è¨˜äº‹ã‚’èª­ã¿è¾¼ã¿
async function loadDentalNews() {
    try {
        const response = await fetch('/news/api/all');
        const data = await response.json();
        allDentalNews = data.items;
        document.getElementById('total-count').textContent = data.count;
        displayNews(allDentalNews);
    } catch (error) {
        console.error('è¨˜äº‹ã®å–å¾—ã«å¤±æ•—:', error);
        document.getElementById('news-container').innerHTML = 
            '<p style="text-align: center; color: red;">è¨˜äº‹ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ</p>';
    }
}

// ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
function filterNews(filter, button) {
    // ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’æ›´æ–°
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    button.classList.add('active');
    
    currentFilter = filter;
    
    let filtered = allDentalNews;
    
    if (filter === 'ja' || filter === 'en') {
        filtered = allDentalNews.filter(item => item.lang === filter);
    } else if (filter !== 'all') {
        filtered = allDentalNews.filter(item => item.kind === filter);
    }
    
    displayNews(filtered);
}

// è¨˜äº‹ã‚’è¡¨ç¤º
function displayNews(items) {
    const container = document.getElementById('news-container');
    
    if (items.length === 0) {
        container.innerHTML = '<p style="text-align: center; padding: 40px; color: #666;">è©²å½“ã™ã‚‹è¨˜äº‹ãŒã‚ã‚Šã¾ã›ã‚“</p>';
        return;
    }
    
    const kindLabels = {
        'research': 'ç ”ç©¶è«–æ–‡',
        'case': 'ç—‡ä¾‹å ±å‘Š',
        'product': 'è£½å“æƒ…å ±',
        'video': 'å‹•ç”»',
        'market': 'å¸‚å ´ãƒ¬ãƒãƒ¼ãƒˆ'
    };
    
    container.innerHTML = items.map(item => {
        const kindLabel = kindLabels[item.kind] || 'æƒ…å ±';
        const langFlag = item.lang === 'ja' ? 'ğŸ‡¯ğŸ‡µ' : 'ğŸ‡¬ğŸ‡§';
        
        return `
            <article class="news-card">
                <div class="news-card-content">
                    <div class="news-meta">
                        <span class="news-badge badge-${item.kind}">${kindLabel}</span>
                        <span class="lang-flag">${langFlag}</span>
                        <span class="news-date">${item.published_at || 'æ—¥ä»˜ä¸æ˜'}</span>
                    </div>
                    
                    <h3 class="news-card-title">
                        <a href="${item.url}" target="_blank" rel="noopener noreferrer">
                            ${item.title}
                        </a>
                    </h3>
                    
                    ${item.ai_summary ? `
                        <p class="news-summary">ğŸ“ ${item.ai_summary}</p>
                    ` : ''}
                    
                    ${item.author ? `
                        <p class="news-author">å‡ºå…¸: ${item.author}</p>
                    ` : ''}
                </div>
            </article>
        `;
    }).join('');
}

// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å®Ÿè¡Œ
document.addEventListener('DOMContentLoaded', () => {
    loadDentalNews();
});
</script>

{% endblock %}